
#include "instructionsSet.h"

const std::map<std::string, uint8_t> dataDefiningInstructions = {
	{ "db", 1 },  // 1 byte
	{ "dw", 2 },  // word : 2 bytes
	{ "dd", 4 },  // double word:  4 bytes
	{ "dq", 8 },  // quad word: 8 bytes
};

const std::map<std::string, const std::multimap<Opcode, InstructionInfo>> instructions = {
	{
		"org",
		{}
	},
	{
		"ret",
		{
			{ { 0xC2 }, { { "I", "" }, { 2, 0 } } },
			{ { 0xC3 }, { { "", "" }, { 0, 0 } } },
		}
	},
	{
		"mov",
		{
			{ { 0x88 }, { { "M", "G" }, { 1, 1 } } },
			{ { 0x89 }, { { "M", "G" }, { 2, 2 } } },
			{ { 0x8A }, { { "G", "M" }, { 1, 1 } } },
			{ { 0x8B }, { { "G", "M" }, { 2, 2 } } },
			{ { 0x8A }, { { "G", "G" }, { 1, 1 } } },
			{ { 0x8B }, { { "G", "G" }, { 2, 2 } } },
			{ { 0x8C }, { { "M", "S" }, { 2, 2 } } },
			{ { 0x8E }, { { "S", "M" }, { 2, 2 } } },
			{ { 0x8C }, { { "G", "S" }, { 2, 2 } } },
			{ { 0x8E }, { { "S", "G" }, { 2, 2 } } },
			{ { 0xB0 }, { { "al", "I" }, { 1, 1 } } },
			{ { 0xB1 }, { { "cl", "I" }, { 1, 1 } } },
			{ { 0xB2 }, { { "dl", "I" }, { 1, 1 } } },
			{ { 0xB3 }, { { "bl", "I" }, { 1, 1 } } },
			{ { 0xB4 }, { { "ah", "I" }, { 1, 1 } } },
			{ { 0xB5 }, { { "ch", "I" }, { 1, 1 } } },
			{ { 0xB7 }, { { "dh", "I" }, { 1, 1 } } },
			{ { 0xB8 }, { { "bh", "I" }, { 1, 1 } } },

			{ { 0xB8 }, { { "ax", "I" }, { 2, 2 } } },
			{ { 0xB9 }, { { "cx", "I" }, { 2, 2 } } },
			{ { 0xBA }, { { "dx", "I" }, { 2, 2 } } },
			{ { 0xBB }, { { "bx", "I" }, { 2, 2 } } },
			{ { 0xBC }, { { "sp", "I" }, { 2, 2 } } },
			{ { 0xBD }, { { "bp", "I" }, { 2, 2 } } },
			{ { 0xBE }, { { "si", "I" }, { 2, 2 } } },
			{ { 0xBF }, { { "di", "I" }, { 2, 2 } } },

			{ { 0xC6 }, { { "M", "I" }, { 1, 1 } } },
			{ { 0xC7 }, { { "M", "I" }, { 2, 2 } } },
		}
	},
	{
		"int",
		{
			{ { 0xCD }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jmp",
		{
			{ { 0xE9 }, { { "J",  "" }, { 2, 0 }}},
			{ { 0xEA }, { { "I",  "" }, { 2, 0 }}},
			{ { 0xFF, 4 }, { { "G",  "" }, { 2, 0 }}},
			{ { 0xFF, 5 }, { { "M",  "" }, { 2, 0 }}},
		}
	},
	{
		"jmp_short",
		{
			{ { 0xEB }, { { "J",  "" }, { 1, 0 }}},
			{ { 0xEB }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"add",
		{
			{ { 0x00 }, { { "M",  "G" }, { 1, 1 }}},
			{ { 0x01 }, { { "M",  "G" }, { 2, 2 }}},
			{ { 0x02 }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x03 }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x00 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x01 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0x04 }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0x05 }, { { "ax",  "I" }, { 2, 2 }}},
			{ { 0x80 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0x80 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0x81 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0x81 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0x83 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0x83 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"adc",
		{
			{ { 0x10 }, { { "M",  "G" }, { 1, 1 }}},
			{ { 0x11 }, { { "M",  "G" }, { 2, 2 }}},
			{ { 0x12 }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x13 }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x10 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x11, 0 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0x14 }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0x15 }, { { "ax",  "I" }, { 2, 2 }}},
			{ { 0x80, 2 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0x80, 2 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0x81, 2 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0x81, 2 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0x83, 2 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0x83, 2 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"push",
		{
			{ { 0x06 }, { { "es", "" }, { 2, 0 } } },
			{ { 0x16 }, { { "ss", "" }, { 2, 0 } } },
			{ { 0x50 }, { { "ax", "" }, { 2, 0 } } },
			{ { 0x51 }, { { "cx", "" }, { 2, 0 } } },
			{ { 0x52 }, { { "dx", "" }, { 2, 0 } } },
			{ { 0x53 }, { { "bx", "" }, { 2, 0 } } },
			{ { 0x54 }, { { "sp", "" }, { 2, 0 } } },
			{ { 0x55 }, { { "bp", "" }, { 2, 0 } } },
			{ { 0x56 }, { { "si", "" }, { 2, 0 } } },
			{ { 0x57 }, { { "di", "" }, { 2, 0 } } },
			{ { 0x0E }, { { "cs", "" }, { 2, 0 } } },
			{ { 0x1E }, { { "ds", "" }, { 2, 0 } } },
			{ { 0xFF, 6 }, { { "M", "" }, { 2, 0 } } },
			{ { 0xFF, 6 }, { { "G", "" }, { 2, 0 } } },
		}
	},
	{
		"pop",
		{
			{ { 0x07 }, { { "es", "" }, { 2, 0 } } },
			{ { 0x17 }, { { "ss", "" }, { 2, 0 } } },
			{ { 0x58 }, { { "ax", "" }, { 2, 0 } } },
			{ { 0x59 }, { { "cx", "" }, { 2, 0 } } },
			{ { 0x5A }, { { "dx", "" }, { 2, 0 } } },
			{ { 0x5B }, { { "bx", "" }, { 2, 0 } } },
			{ { 0x5C }, { { "sp", "" }, { 2, 0 } } },
			{ { 0x5D }, { { "bp", "" }, { 2, 0 } } },
			{ { 0x5E }, { { "si", "" }, { 2, 0 } } },
			{ { 0x5F }, { { "di", "" }, { 2, 0 } } },
			{ { 0x1F }, { { "ds", "" }, { 2, 0 } } },
			{ { 0x8F }, { { "M", "" }, { 2, 0 } } },
			{ { 0x8F }, { { "G", "" }, { 2, 0 } } },
		}
	},
	{
		"and",
		{
			{ { 0x20 }, { { "M",  "G" }, { 1, 1 }}},
			{ { 0x21 }, { { "M",  "G" }, { 2, 2 }}},
			{ { 0x22 }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x23 }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x20 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x21 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0x24 }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0x25 }, { { "ax",  "I" }, { 2, 2 }}},
			{ { 0x80, 4 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0x80, 4 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0x81, 4 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0x81, 4 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0x83, 4 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0x83, 4 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"xor",
		{
			{ { 0x30 }, { { "M",  "G" }, { 1, 1 }}},
			{ { 0x31 }, { { "M",  "G" }, { 2, 2 }}},
			{ { 0x32 }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x33 }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x30 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x31 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0x34 }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0x35 }, { { "ax",  "I" }, { 2, 2 }}},
			{ { 0x80, 6 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0x80, 6 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0x81, 6 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0x81, 6 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0x83, 6 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0x83, 6 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"inc",
		{
			{ { 0x40 }, { { "ax",  "" }, { 2, 0 }}},
			{ { 0x41 }, { { "cx",  "" }, { 2, 0 }}},
			{ { 0x42 }, { { "dx",  "" }, { 2, 0 }}},
			{ { 0x43 }, { { "bx",  "" }, { 2, 0 }}},
			{ { 0x44 }, { { "sp",  "" }, { 2, 0 }}},
			{ { 0x45 }, { { "bp",  "" }, { 2, 0 }}},
			{ { 0x46 }, { { "si",  "" }, { 2, 0 }}},
			{ { 0x47 }, { { "di",  "" }, { 2, 0 }}},
			{ { 0xFE, 0 }, { { "M",  "" }, { 1, 0 }}},
			{ { 0xFF, 0 }, { { "M",  "" }, { 2, 0 }}},
			{ { 0xFE, 0 }, { { "G",  "" }, { 1, 0 }}},
			{ { 0xFF, 0 }, { { "G",  "" }, { 2, 0 }}},
		}
	},
	{
		"jo",
		{
			{ { 0x70 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x70 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jno",
		{
			{ { 0x71 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x71 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jb",
		{
			{ { 0x72 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x72 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jnb",
		{
			{ { 0x73 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x73 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jz",
		{
			{ { 0x74 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x74 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jnz",
		{
			{ { 0x75 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x75 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jbe",
		{
			{ { 0x76 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x76 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"ja",
		{
			{ { 0x77 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x77 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"test",
		{
			{ { 0x84 }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x85 }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x84 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x85 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0xA8 }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0xA9 }, { { "ax",  "I" }, { 2, 2 }}},
			{ { 0xF6, 0 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0xF7, 0 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0xF6, 0 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0xF7, 0 }, { { "G",  "I" }, { 2, 2 }}},
		}
	},
	{
		"xchg",
		{
			{ { 0x86 }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x87 }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x86 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x87 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0x91 }, { { "cx",  "ax" }, { 2, 2 }}},
			{ { 0x92 }, { { "dx",  "ax" }, { 2, 2 }}},
			{ { 0x93 }, { { "bx",  "ax" }, { 2, 2 }}},
			{ { 0x94 }, { { "sp",  "ax" }, { 2, 2 }}},
			{ { 0x95 }, { { "bp",  "ax" }, { 2, 2 }}},
			{ { 0x96 }, { { "si",  "ax" }, { 2, 2 }}},
			{ { 0x97 }, { { "di",  "ax" }, { 2, 2 }}},
		}
	},
	{
		"nop",
		{
			{ { 0x90 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"movsb",
		{
			{ { 0xA4 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"movsw",
		{
			{ { 0xA5 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"cmpsb",
		{
			{ { 0xA6 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"cmpsw",
		{
			{ { 0xA7 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"les",
		{
			{ { 0xC4 }, { { "G",  "M" }, { 2, 2 }}},
		}
	},
	{
		"lds",
		{
			{ { 0xC5 }, { { "G",  "M" }, { 2, 2 }}},
		}
	},
	{
		"aam",
		{
			{ { 0xD4 }, { { "I",  "" }, { 1, 0 }}},
		}
	},
	{
		"aad",
		{
			{ { 0xD5 }, { { "I",  "" }, { 1, 0 }}},
		}
	},
	{
		"xlat",
		{
			{ { 0xD7 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"loopnz",
		{
			{ { 0xE0 }, { { "I",  "" }, { 1, 0 }}},
		}
	},
	{
		"loopz",
		{
			{ { 0xE1 }, { { "I",  "" }, { 1, 0 }}},
		}
	},
	{
		"loop",
		{
			{ { 0xE2 }, { { "I",  "" }, { 1, 0 }}},
		}
	},
	{
		"jcxz",
		{
			{ { 0xE3 }, { { "I",  "" }, { 1, 0 }}},
		}
	},
	{
		"in",
		{
			{ { 0xE4 }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0xE5 }, { { "ax",  "I" }, { 2, 1 }}},
		}
	},
	{
		"out",
		{
			{ { 0xE6 }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0xE7 }, { { "ax",  "I" }, { 2, 1 }}},
		}
	},
	{
		"lock",
		{
			{ { 0xF0 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"repnz",
		{
			{ { 0xF2 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"repz",
		{
			{ { 0xF3 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"hlt",
		{
			{ { 0xF4 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"cmc",
		{
			{ { 0xF5 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"or",
		{
			{ { 0x08 }, { { "M",  "G" }, { 1, 1 }}},
			{ { 0x09 }, { { "M",  "G" }, { 2, 2 }}},
			{ { 0x0A }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x0B }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x08 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x09 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0x0C }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0x0D }, { { "ax",  "I" }, { 2, 2 }}},
			{ { 0x80, 1 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0x80, 1 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0x81, 1 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0x81, 1 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0x83, 1 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0x83, 1 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"sbb",
		{
			{ { 0x18 }, { { "M",  "G" }, { 1, 1 }}},
			{ { 0x19 }, { { "M",  "G" }, { 2, 2 }}},
			{ { 0x1A }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x1B }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x18 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x19 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0x1C }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0x1D }, { { "ax",  "I" }, { 2, 2 }}},
			{ { 0x80, 3 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0x80, 3 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0x81, 3 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0x81, 3 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0x83, 3 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0x83, 3 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"sub",
		{
			{ { 0x28 }, { { "M",  "G" }, { 1, 1 }}},
			{ { 0x29 }, { { "M",  "G" }, { 2, 2 }}},
			{ { 0x2A }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x2B }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x28 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x29 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0x2C }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0x2D }, { { "ax",  "I" }, { 2, 2 }}},
			{ { 0x80, 5 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0x80, 5 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0x81, 5 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0x81, 5 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0x83, 5 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0x83, 5 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"cmp",
		{
			{ { 0x38 }, { { "M",  "G" }, { 1, 1 }}},
			{ { 0x39 }, { { "M",  "G" }, { 2, 2 }}},
			{ { 0x3A }, { { "G",  "M" }, { 1, 1 }}},
			{ { 0x3B }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x38 }, { { "G",  "G" }, { 1, 1 }}},
			{ { 0x39 }, { { "G",  "G" }, { 2, 2 }}},
			{ { 0x3C }, { { "al",  "I" }, { 1, 1 }}},
			{ { 0x3D }, { { "ax",  "I" }, { 2, 2 }}},
			{ { 0x80, 7 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0x80, 7 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0x81, 7 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0x81, 7 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0x83, 7 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0x83, 7 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"dec",
		{
			{ { 0x48 }, { { "ax",  "" }, { 2, 0 }}},
			{ { 0x49 }, { { "cx",  "" }, { 2, 0 }}},
			{ { 0x4A }, { { "dx",  "" }, { 2, 0 }}},
			{ { 0x4B }, { { "bx",  "" }, { 2, 0 }}},
			{ { 0x48 }, { { "sp",  "" }, { 2, 0}}},
			{ { 0x49 }, { { "bp",  "" }, { 2, 0 }}},
			{ { 0x4C }, { { "si",  "" }, { 2, 0 }}},
			{ { 0x4D }, { { "di",  "" }, { 2, 0 }}},
			{ { 0xFE, 1 }, { { "M",  "" }, { 1, 0 }}},
			{ { 0xFF, 1 }, { { "M",  "" }, { 2, 0 }}},
			{ { 0xFE, 1 }, { { "G",  "" }, { 1, 0 }}},
			{ { 0xFF, 1 }, { { "G",  "" }, { 2, 0 }}},
		}
	},
	{
		"js",
		{
			{ { 0x78 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x78 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jns",
		{
			{ { 0x79 }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x79 }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jpe",
		{
			{ { 0x7A }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x7A }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jpo",
		{
			{ { 0x7B }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x7B }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jl",
		{
			{ { 0x7C }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x7C }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jge",
		{
			{ { 0x7D }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x7D }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jle",
		{
			{ { 0x7E }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x7E }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"jg",
		{
			{ { 0x7F }, { { "J",  "" }, { 1, 0 }}},
			{ { 0x7F }, { { "I",  "" }, { 1, 0 }}}
		}
	},
	{
		"lea",
		{
			{ { 0x8D }, { { "G",  "M" }, { 2, 2 }}},
			{ { 0x8D }, { { "G",  "G" }, { 2, 2 }}}
		}
	},
	{
		"cbw",
		{
			{ { 0x98 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"cwd",
		{
			{ { 0x99 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"call",
		{
			{ { 0x9A }, { { "I",  "" }, { 2, 0 }}},
			{ { 0xE8 }, { { "J",  "" }, { 2, 0 }}},
			{ { 0xFF, 2 }, { { "G",  "" }, { 2, 0 }}},
			{ { 0xFF, 3 }, { { "M",  "" }, { 2, 0 }}},
		}
	},
	{
		"wait",
		{
			{ { 0x9B }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"pushf",
		{
			{ { 0x9C }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"popf",
		{
			{ { 0x9D }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"sahf",
		{
			{ { 0x9E }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"lahf",
		{
			{ { 0x9F }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"stosb",
		{
			{ { 0xAA }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"stosw",
		{
			{ { 0xAB }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"lodsb",
		{
			{ { 0xAC }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"lodsw",
		{
			{ { 0xAD }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"scasb",
		{
			{ { 0xAE }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"scasw",
		{
			{ { 0xAF }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"retf",
		{
			{ { 0xCA }, { { "I",  "" }, { 2, 0 }}},
			{ { 0xCB }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"into",
		{
			{ { 0xCE }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"iret",
		{
			{ { 0xCF }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"clc",
		{
			{ { 0xF8 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"stc",
		{
			{ { 0xF9 }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"cli",
		{
			{ { 0xFA }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"sti",
		{
			{ { 0xFB }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"cld",
		{
			{ { 0xFC }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"std",
		{
			{ { 0xFD }, { { "",  "" }, { 0, 0 }}},
		}
	},
	{
		"rol",
		{
			{ { 0xD0, 0 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0xD1, 0 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0xD2, 0 }, { { "M",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 0 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0xD0, 0 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0xD1, 0 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0xD2, 0 }, { { "G",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 0 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"ror",
		{
			{ { 0xD0, 1 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0xD1, 1 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0xD2, 1 }, { { "M",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 1 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0xD0, 1 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0xD1, 1 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0xD2, 1 }, { { "G",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 1 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"rcl",
		{
			{ { 0xD0, 2 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0xD1, 2 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0xD2, 2 }, { { "M",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 2 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0xD0, 2 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0xD1, 2 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0xD2, 2 }, { { "G",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 2 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"rcr",
		{
			{ { 0xD0, 3 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0xD1, 3 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0xD2, 3 }, { { "M",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 3 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0xD0, 3 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0xD1, 3 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0xD2, 3 }, { { "G",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 3 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"shl",
		{
			{ { 0xD0, 4 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0xD1, 4 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0xD2, 4 }, { { "M",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 4 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0xD0, 4 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0xD1, 4 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0xD2, 4 }, { { "G",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 4 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"shr",
		{
			{ { 0xD0, 5 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0xD1, 5 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0xD2, 5 }, { { "M",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 5 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0xD0, 5 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0xD1, 5 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0xD2, 5 }, { { "G",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 5 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"sar",
		{
			{ { 0xD0, 7 }, { { "M",  "I" }, { 1, 1 }}},
			{ { 0xD1, 7 }, { { "M",  "I" }, { 2, 2 }}},
			{ { 0xD2, 7 }, { { "M",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 7 }, { { "M",  "I" }, { 2, 1 }}},
			{ { 0xD0, 7 }, { { "G",  "I" }, { 1, 1 }}},
			{ { 0xD1, 7 }, { { "G",  "I" }, { 2, 2 }}},
			{ { 0xD2, 7 }, { { "G",  "cl" }, { 1, 1 }}},
			{ { 0xD3, 7 }, { { "G",  "I" }, { 2, 1 }}},
		}
	},
	{
		"not",
		{
			{ { 0xF6, 2 }, { { "M",  "" }, { 1, 0 }}},
			{ { 0xF7, 2 }, { { "M",  "" }, { 2, 0 }}},
			{ { 0xF6, 2 }, { { "G",  "" }, { 1, 0 }}},
			{ { 0xF7, 2 }, { { "G",  "" }, { 2, 0 }}},
		}
	},
	{
		"neg",
		{
			{ { 0xF6, 3 }, { { "M",  "" }, { 1, 0 }}},
			{ { 0xF7, 3 }, { { "M",  "" }, { 2, 0 }}},
			{ { 0xF6, 3 }, { { "G",  "" }, { 1, 0 }}},
			{ { 0xF7, 3 }, { { "G",  "" }, { 2, 0 }}},
		}
	},
	{
		"mul",
		{
			{ { 0xF6, 4 }, { { "M",  "" }, { 1, 0 }}},
			{ { 0xF7, 4 }, { { "M",  "" }, { 2, 0 }}},
			{ { 0xF6, 4 }, { { "G",  "" }, { 1, 0 }}},
			{ { 0xF7, 4 }, { { "G",  "" }, { 2, 0 }}},
		}
	},
	{
		"imul",
		{
			{ { 0xF6, 5 }, { { "M",  "" }, { 1, 0 }}},
			{ { 0xF7, 5 }, { { "M",  "" }, { 2, 0 }}},
			{ { 0xF6, 5 }, { { "G",  "" }, { 1, 0 }}},
			{ { 0xF7, 5 }, { { "G",  "" }, { 2, 0 }}},
		}
	},
	{
		"div",
		{
			{ { 0xF6, 6 }, { { "M",  "" }, { 1, 0 }}},
			{ { 0xF7, 6 }, { { "M",  "" }, { 2, 0 }}},
			{ { 0xF6, 6 }, { { "G",  "" }, { 1, 0 }}},
			{ { 0xF7, 6 }, { { "G",  "" }, { 2, 0 }}},
		}
	},
	{
		"idiv",
		{
			{ { 0xF6, 7 }, { { "M",  "" }, { 1, 0 }}},
			{ { 0xF7, 7 }, { { "M",  "" }, { 2, 0 }}},
			{ { 0xF6, 7 }, { { "G",  "" }, { 1, 0 }}},
			{ { 0xF7, 7 }, { { "G",  "" }, { 2, 0 }}},
		}
	},
	{
		"use_es",
		{
			{ { 0x26 }, { { "",  "" }, { 0, 0 }}}
		}
	},
	{
		"use_ss",
		{
			{ { 0x36 }, { { "",  "" }, { 0, 0 }}}
		}
	},
	{
		"use_cs",
		{
			{ { 0x2E }, { { "",  "" }, { 0, 0 }}}
		}
	},
	{
		"use_ds",
		{
			{ { 0x3E }, { { "",  "" }, { 0, 0 }}}
		}
	},
};

bool checkInstuction(std::string instruction)
{
	return instructions.find(instruction) != instructions.end();
}

std::pair<int8_t, int8_t> getInstructionOpcode(const std::string& instruction, const std::string& operandA, const std::string operandB, uint8_t* sizeA, uint8_t* sizeB, bool isSizeAIdentical, bool isSizeBIdentical)
{
	const auto& opcodes = instructions.at(instruction);
	for (const auto& [opcode, info] : opcodes)
	{
		if (info.operands[0] == operandA && info.operands[1] == operandB)
		{
			if (
				((uint8_t)sizeA == info.operandsSizes[0] || (sizeA && (!isSizeAIdentical && *sizeA == info.operandsSizes[0] || *sizeA <= info.operandsSizes[0])))
				&&
				((uint8_t)sizeB == info.operandsSizes[1] || (sizeB && (!isSizeBIdentical && *sizeB == info.operandsSizes[1] || *sizeB <= info.operandsSizes[1])))
			)
			{
				if (sizeA)
				{
					*sizeA = info.operandsSizes[0];
				}
				if (sizeB)
				{
					*sizeB = info.operandsSizes[1];
				}
				return { opcode.opcode, opcode.opcodeExtension };
			}

		}
	}
	return { -1, -1 };
}

